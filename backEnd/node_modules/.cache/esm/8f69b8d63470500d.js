let CNAB,SequelizeConnection,Return,TipoTransacao,Op,Sequelize;_347‍.x([["default",()=>_347‍.o]]);_347‍.w("../Models/CNAB",[["default",["CNAB"],function(v){CNAB=v}]]);_347‍.w("../Connections/SequelizeConnection",[["default",["SequelizeConnection"],function(v){SequelizeConnection=v}]]);_347‍.w("../Models/Return",[["default",["Return"],function(v){Return=v}]]);_347‍.w("../Models/TipoTransacao",[["default",["TipoTransacao"],function(v){TipoTransacao=v}]]);_347‍.w("sequelize",[["Op",["Op"],function(v){Op=v}],["Sequelize",["Sequelize"],function(v){Sequelize=v}]]);





class UploadRepository extends SequelizeConnection {
    constructor() {
        super();
    }
    async upload(obj) {
        let retorno = await CNAB.create({
			tipoTransacao: parseInt(obj.tipoTransacao),
			data: obj.data,
			valor: parseFloat(obj.valor),
			cpf: obj.cpf,
			cartao: obj.cartao,
			hora: obj.hora,
			donoLoja: obj.donoLoja.replace(/\s+/g,' ').trim(),
			nomeLoja: obj.nomeLoja.replace(/\s+/g,' ').trim()
		});
		if (!retorno.dataValues)
			return new Return(201, 'Falha ao inserir os dados');

		return new Return(200, 'OK', retorno.dataValues);
    }

  
	async getAll()
	{
		let results = await CNAB.findAll({
			attributes: [
				'tipoTransacao',
				'data',
				'valor',
				'cpf',
				'cartao',
				'hora',
				'donoLoja',
				'nomeLoja',
				'dataUpload',
			],
            include: [
                {
                  model: TipoTransacao,
                  required: true,
                  attributes: ['tipo', 'descricao', 'natureza', 'sinal'],
                  on: {
                    [Op.and]: [
                      {
                        tipoTransacao: Sequelize.where(Sequelize.col("TipoTransacao.tipo"), "=", Sequelize.col("CNAB.tipoTransacao"))
                      }
                    ]
                  },
                }],
                order: [['id', 'DESC']],
		});

		return new Return(200, 'OK', results);
	}

}

_347‍.d(new UploadRepository());